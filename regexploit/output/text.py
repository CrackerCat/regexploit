class TextOutput:
    def __init__(self):
        self.first_for_regex = True
        self.regexes = 0

    def next(self):
        """Next regex being processed."""
        self.first_for_regex = True
        self.regexes += 1

    def record(self, redos, pattern, *, filename=None, lineno=None, context=None):
        if self.first_for_regex:
            if filename:
                if lineno is not None:
                    print(f"Vulnerable regex in {filename} #{lineno}")
                else:
                    print(f"Vulnerable regex in {filename}")
            print(f"Pattern: {pattern}")
            if context:
                print(f"Context: {context}")
            print("---")
            self.first_for_regex = False
        stars = "\u2b50" * min(10, redos.starriness)
        print(f"Starriness: {redos.starriness} {stars}")
        print(f"Repeated character: {redos.repeated_character}")
        if redos.killer:
            print(f"Final character to cause backtracking: {redos.killer}")
        print(f"Example: {redos.example()}\n")
