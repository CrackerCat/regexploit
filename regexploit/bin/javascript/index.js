#!/usr/bin/env node
const readline = require('readline');
const cli = require('./cli');

const args = process.argv.slice(2)


if (args.length == 1 && args[0] == '-') {
  process.stdin.setEncoding('utf-8');
  var data = "";
  readline.createInterface({input: process.stdin})
    .on('line', l => data += l)
    .on('close', () => {
      for (const output of cli.parseCode(data)) {
        console.log(output);
      }
    })
} else {
  (async () => {
    for (const filename of args) {
      for await (let output of cli.parseFile(filename)) {
        console.log(output);
      }
    }
  })()
}
